<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" width="2231" height="689" version="1.1" viewBox="340 148 2231 689"><defs><clipPath id="outer_stroke_clip_path"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 737 258 L 737 312 L 958 312 L 958 258 Z"/></clipPath><font-face x-height="482.422" ascent="1038.574" cap-height="761.231" descent="-259.766" font-family="Futura" font-size="19" font-weight="500" panose-1="2 11 6 2 2 2 4 2 3 3" slope="0" underline-position="-97.656" underline-thickness="78.125" units-per-em="1000"><font-face-src><font-face-name name="Futura-Medium"/></font-face-src></font-face><clipPath id="outer_stroke_clip_path_2"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 960 258 L 960 312 L 1290.0293 312 L 1290.0293 258 Z"/></clipPath><font-face x-height="513" ascent="1039.002" cap-height="754" descent="-259.995" font-family="Futura" font-size="25" font-weight="700" panose-1="2 11 8 2 2 2 4 2 2 4" slope="0" underline-position="-75" underline-thickness="50" units-per-em="1000"><font-face-src><font-face-name name="Futura-Bold"/></font-face-src></font-face><font-face x-height="482.422" ascent="1038.574" cap-height="761.231" descent="-259.766" font-family="Futura" font-size="21" font-weight="500" panose-1="2 11 6 2 2 2 4 2 3 3" slope="0" underline-position="-97.656" underline-thickness="78.125" units-per-em="1000"><font-face-src><font-face-name name="Futura-Medium"/></font-face-src></font-face><clipPath id="outer_stroke_clip_path_3"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 737 406 L 737 460 L 1290.0293 460 L 1290.0293 406 Z"/></clipPath><clipPath id="outer_stroke_clip_path_4"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 737 730 L 737 784 L 962.4919 784 L 962.4919 730 Z"/></clipPath><clipPath id="outer_stroke_clip_path_5"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 967.0166 730 L 967.0166 784 L 1188.0166 784 L 1188.0166 730 Z"/></clipPath><clipPath id="outer_stroke_clip_path_6"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 1189.0459 730 L 1189.0459 784 L 1404.0459 784 L 1404.0459 730 Z"/></clipPath><clipPath id="outer_stroke_clip_path_7"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 1406.5374 730 L 1406.5374 784 L 1632.0293 784 L 1632.0293 730 Z"/></clipPath><clipPath id="outer_stroke_clip_path_8"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 1634.5207 730 L 1634.5207 784 L 1964.55 784 L 1964.55 730 Z"/></clipPath><clipPath id="outer_stroke_clip_path_9"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 1968 730 L 1968 784 L 2231.0293 784 L 2231.0293 730 Z"/></clipPath><font-face x-height="482.422" ascent="1038.574" cap-height="761.231" descent="-259.766" font-family="Futura" font-size="20" font-weight="500" panose-1="2 11 6 2 2 2 4 2 3 3" slope="0" underline-position="-97.656" underline-thickness="78.125" units-per-em="1000"><font-face-src><font-face-name name="Futura-Medium"/></font-face-src></font-face><clipPath id="outer_stroke_clip_path_10"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 2234.4253 730 L 2234.4253 784 L 2467 784 L 2467 730 Z"/></clipPath><clipPath id="outer_stroke_clip_path_11"><path d="M 340 148 L 2571 148 L 2571 837 L 340 837 Z M 2471 730 L 2471 784 L 2563.287 784 L 2563.287 730 Z"/></clipPath></defs><metadata>Produced by OmniGraffle 7.9.4</metadata><g id="Netcap-Batch" fill="none" fill-opacity="1" stroke="none" stroke-dasharray="none" stroke-opacity="1"><title>Netcap-Batch</title><g id="Netcap-Batch: Layer 1"><title>Layer 1</title><g id="Graphic_168"><rect width="221" height="54" x="737" y="258" fill="#fff"/><rect width="221" height="54" x="737" y="258" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path)"/><text fill="#000" transform="translate(742 272.21704)"><tspan x="19.188" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">PUBLIC KEY CLIENT</tspan></text></g><g id="Graphic_167"><rect width="330.029" height="54" x="960" y="258" fill="#fff"/><rect width="330.029" height="54" x="960" y="258" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_2)"/><text fill="#000" transform="translate(965 272.21704)"><tspan x="117.316" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">PAYLOAD</tspan></text></g><g id="Line_158"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M 737 217.81095 L 737 200.05613 L 1290.0293 200.05613 L 1290.0293 221.29353"/></g><g id="Graphic_157"><text fill="#000" transform="translate(924.5146 153.12502)"><tspan x=".237" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">UDP Payload</tspan></text></g><g id="Graphic_156"><text fill="#000" transform="translate(808.5 328.18726)"><tspan x=".214" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">32 byte</tspan></text></g><g id="Graphic_155"><text fill="#000" transform="translate(1048.5146 328.18726)"><tspan x=".293" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">encrypted bytes</tspan></text></g><g id="Graphic_181"><rect width="553.029" height="54" x="737" y="406" fill="#fff"/><rect width="553.029" height="54" x="737" y="406" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_3)"/><text fill="#000" transform="translate(742 420.21704)"><tspan x="228.816" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">PAYLOAD</tspan></text></g><g id="Graphic_170"><text fill="#000" transform="translate(946.0146 486.18726)"><tspan x=".111" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">gzipped bytes</tspan></text></g><g id="Graphic_186"><text fill="#000" transform="translate(352 275.125)"><tspan x=".113" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">Step 1: decrypt</tspan></text></g><g id="Graphic_187"><text fill="#000" transform="translate(345 417.625)"><tspan x=".087" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">Step 2: decompress</tspan></text></g><g id="Graphic_188"><text fill="#000" transform="translate(345 741.625)"><tspan x=".388" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">Step 3: unmarshal batch</tspan></text></g><g id="Graphic_204"><rect width="225.492" height="54" x="737" y="730" fill="#fff"/><rect width="225.492" height="54" x="737" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_4)"/><text fill="#000" transform="translate(742 744.217)"><tspan x="63.47" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">CLIENT ID</tspan></text></g><g id="Graphic_203"><rect width="221" height="54" x="967.017" y="730" fill="#fff"/><rect width="221" height="54" x="967.017" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_5)"/><text fill="#000" transform="translate(972.0166 744.217)"><tspan x="35.725" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">MESSAGE TYPE</tspan></text></g><g id="Line_202"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M 737 622.14925 L 737 606 L 2568.479 606 L 2568.479 652.29244"/></g><g id="Graphic_201"><text fill="#000" transform="translate(1608.7396 559.125)"><tspan x=".138" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">BATCH</tspan></text></g><g id="Graphic_200"><rect width="215" height="54" x="1189.046" y="730" fill="#fff"/><rect width="215" height="54" x="1189.046" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_6)"/><text fill="#000" transform="translate(1194.0459 744.217)"><tspan x="82.851" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">SIZE</tspan></text></g><g id="Graphic_199"><rect width="225.492" height="54" x="1406.537" y="730" fill="#fff"/><rect width="225.492" height="54" x="1406.537" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_7)"/><text fill="#000" transform="translate(1411.5374 744.217)"><tspan x="70.535" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">LENGTH</tspan></text></g><g id="Graphic_198"><rect width="330.029" height="54" x="1634.521" y="730" fill="#fff"/><rect width="330.029" height="54" x="1634.521" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_8)"/><text fill="#000" transform="translate(1639.5207 744.217)"><tspan x="90.212" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">AUDIT RECORD</tspan></text></g><g id="Graphic_197"><rect width="263.029" height="54" x="1968" y="730" fill="#fff"/><rect width="263.029" height="54" x="1968" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_9)"/><text fill="#000" transform="translate(1973 743.70215)"><tspan x="87.345" y="21" fill="#000" font-family="Futura" font-size="20" font-weight="500">LENGTH</tspan></text></g><g id="Graphic_196"><rect width="232.575" height="54" x="2234.425" y="730" fill="#fff"/><rect width="232.575" height="54" x="2234.425" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_10)"/><text fill="#000" transform="translate(2239.4253 744.217)"><tspan x="41.485" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">AUDIT RECORD</tspan></text></g><g id="Graphic_195"><rect width="92.287" height="54" x="2471" y="730" fill="#fff"/><rect width="92.287" height="54" x="2471" y="730" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" clip-path="url(#outer_stroke_clip_path_11)"/><text fill="#000" transform="translate(2476 744.217)"><tspan x="32.172" y="20" fill="#000" font-family="Futura" font-size="19" font-weight="500">…</tspan></text></g><g id="Line_194"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M 737 689.81095 L 737 672.0561 L 1404.0459 672.0561 L 1404.0459 691.1111"/></g><g id="Graphic_193"><text fill="#000" transform="translate(937.0166 625.125)"><tspan x=".237" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">META INFORMATION</tspan></text></g><g id="Graphic_192"><text fill="#000" transform="translate(821.5 800.1873)"><tspan x=".124" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">string</tspan></text></g><g id="Graphic_191"><text fill="#000" transform="translate(1019.523 800.1873)"><tspan x=".412" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">types.Type</tspan></text></g><g id="Line_206"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M 1413 691.1111 L 1413 672.0561 L 2568.479 672.0561 L 2568.479 699.44444"/></g><g id="Graphic_205"><text fill="#000" transform="translate(1769 625.125)"><tspan x=".375" y="26" fill="#000" font-family="Futura" font-size="25" font-weight="700">SERIALIZED AUDIT RECORDS</tspan></text></g><g id="Graphic_207"><text fill="#000" transform="translate(1272.0459 804.1873)"><tspan x=".296" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">int32</tspan></text></g><g id="Graphic_208"><text fill="#000" transform="translate(1492.2833 804.1873)"><tspan x=".278" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">varint</tspan></text></g><g id="Graphic_209"><text fill="#000" transform="translate(1774.5354 804.1873)"><tspan x=".155" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">bytes</tspan></text></g><g id="Graphic_210"><text fill="#000" transform="translate(2072.5146 804.1873)"><tspan x=".278" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">varint</tspan></text></g><g id="Graphic_211"><text fill="#000" transform="translate(2325.7127 804.1873)"><tspan x=".155" y="22" fill="#000" font-family="Futura" font-size="21" font-weight="500">bytes</tspan></text></g></g></g></svg>